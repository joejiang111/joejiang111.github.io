<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="./stylesheet.css" />
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <title>Most Popular Steam Games By Category</title>
  
  <body>
    
    <div id = "banner">
        <p id = "opaText" style="text-align: left; width:49%; display: inline-block; font-size: 100px;">CS:GO</p>
        <p id = "opaText" style="text-align: right; width:50%;  display: inline-block; font-size: 100px;">GTA 5</p>  
    
    <h1>  Most Popular <br> <p1 style="font-style:italic">Steam </p1>Games </h1>
    
    <h3 style="text-align: center;">
       Let's see the most popular steam games in 8 game categories!
       <br>
       The data used in this website is game-features.csv by Craig Kelly
       <br>
       
    <p style = "text-align: center;">
        Created by Joe
    </p>
    </h3>

    <p id = "opaText" style="text-align: left; width:49%; display: inline-block; font-size: 100px;">DOTA 2</p>
    <p id = "opaText" style="text-align: right; width:50%;  display: inline-block; font-size: 100px;">NBA 2K22</p> 
    
    </div>

    <div class = "section">
        <p style="font-family: Tomorrow, sans-serif; text-align: center; font-weight: bold; font-size: 25px;">
            <br>
            <br>
           Click the buttons below to see 8 categories' most popular 10 games throughout steam history!
           <br>
           <br>
            <button class="btn" style="font-weight: bold" onclick="actions()">
                <span class="btn__content" >Action!!</span>
                <span class="btn__glitch"></span>
                
            </button>

            <button class="btn" style="font-weight: bold" onclick="adventures()">
                <span class="btn__content">Adventure!</span>
                <span class="btn__glitch"></span>
            </button>

            <br>
            
            <button class="btn" style="font-weight: bold;" onclick="casuals()">
                <span class="btn__content">Casual~</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold" onclick="strategies()"> 
                <span class="btn__content">$trategy</span>
                <span class="btn__glitch"></span>
            </button>

            <br>
            
            <button class="btn" style="font-weight: bold" onclick = "multiplayer()">
                <span class="btn__content">MultiPlayer...</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold" onclick="sports()">
                <span class="btn__content">Sp000rts</span>
                <span class="btn__glitch"></span>
            </button>
            
            <br>

            <button class="btn" style="font-weight: bold" onclick="rpg()">
                <span class="btn__content">R P G</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold" onclick="simulation()">
                <span class="btn__content">SSimulation</span>
                <span class="btn__glitch"></span>
            </button>


        </p>
        
        <svg id = "chart1"></svg>
    </div>
    <div class = "section">
        <svg id = "chart2"></svg>
        
        <p style="font-family: Tomorrow, sans-serif; text-align: center; font-weight: bold; font-size: 25px;">
            <br>
            <br>
            Click the Buttons below to see the Trend of each category
            <br>
            <br>
            <button class="btn" style="font-weight: bold;">
                <span class="btn__content" >Action!!</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold">
                <span class="btn__content">Adventure!</span>
                <span class="btn__glitch"></span>
            </button>

            <br>
            
            <button class="btn" style="font-weight: bold;">
                <span class="btn__content">Casual~</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold">
                <span class="btn__content">$trategy</span>
                <span class="btn__glitch"></span>
            </button>

            <br>
            
            <button class="btn" style="font-weight: bold">
                <span class="btn__content">MultiPlayer...</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold">
                <span class="btn__content">Sp000rts</span>
                <span class="btn__glitch"></span>
            </button>
            
            <br>

            <button class="btn" style="font-weight: bold">
                <span class="btn__content">R P G</span>
                <span class="btn__glitch"></span>
            </button>

            <button class="btn" style="font-weight: bold">
                <span class="btn__content">SSimulation</span>
                <span class="btn__glitch"></span>
            </button>
        </p>

    
        
    </div>
    <div class = "section">
        <p style="font-family: Tomorrow, sans-serif; text-align: center; font-weight: bold; font-size: 25px;">
            Fun Facts!
        </p>
        <svg id = "chart3"></svg>
        







    </div>

    <div id = "tooltip"></div>







    <script>
       //filter each category's games data 
        function actions(){
            d3.csv("./games-features.csv", function(data) {
            var actionGames = data.filter(function(row){
                return row["GenreIsAction"] == 'TRUE';
                })
                
                //sort the action games by players
                actionGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];

                })
                console.log(actionGames);
                var topTenActions = actionGames.slice(0,10);
                console.log(topTenActions);
                var title = "Action";
                drawBars(topTenActions, title);
            });
        }
        
        function adventures(){
            d3.csv("./games-features.csv", function(data){
                var adventureGames = data.filter(function(row){
                    return row["GenreIsAdventure"] == 'TRUE';
                })

                adventureGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(adventureGames);
                var topTenAdven = adventureGames.slice(0, 10);
                console.log(topTenAdven);
                var title = "Adventure";
                drawBars(topTenAdven,title);
            })
        }

        function casuals(){
            d3.csv("./games-features.csv", function(data){
                var casualGames = data.filter(function(row){
                    return row["GenreIsCasual"] == 'TRUE';
                })

                casualGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(casualGames);
                var topTenCasual = casualGames.slice(0, 10);
                console.log(topTenCasual);
                var title = "Casual";
                drawBars(topTenCasual,title);
            })
        }

        function strategies(){
            d3.csv("./games-features.csv", function(data){
                var stratGames = data.filter(function(row){
                    return row["GenreIsStrategy"] == 'TRUE';
                })

                stratGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(stratGames);
                var topTenStrat = stratGames.slice(0, 10);
                console.log(topTenStrat);
                var title = "Strategy";
                drawBars(topTenStrat, title);
            })
        }

        function multiplayer(){
            d3.csv("./games-features.csv", function(data){
                var multiGames = data.filter(function(row){
                    return row["GenreIsMassivelyMultiplayer"] == 'TRUE';
                })

                multiGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(multiGames);
                var topTenMulti = multiGames.slice(0, 10);
                console.log(topTenMulti);
                var title = "Multiplayer";
                drawBars(topTenMulti, title);
            })
        }

        function sports(){
            d3.csv("./games-features.csv", function(data){
                var sportsGames = data.filter(function(row){
                    return row["GenreIsSports"] == 'TRUE';
                })

                sportsGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(sportsGames);
                var topTenSports = sportsGames.slice(0, 10);
                console.log(topTenSports);
                var title = "Sport";
                drawBars(topTenSports, title);
            })
        }

        
        function rpg() {

            d3.csv("./games-features.csv", function(data){
                var rpgGames = data.filter(function(row){
                    return row["GenreIsRPG"] == 'TRUE';
                })

                rpgGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(rpgGames);
                var topTenRpg = rpgGames.slice(0, 10);
                console.log(topTenRpg);
                var title = "RPG";
                drawBars(topTenRpg, title);
            })
        }

        function simulation() {
            d3.csv("./games-features.csv", function(data){
                var simGames = data.filter(function(row){
                    return row["GenreIsSimulation"] == 'TRUE';
                })

                simGames.sort(function(x, y){
                    return y["SteamSpyPlayersEstimate"] - x["SteamSpyPlayersEstimate"];
                })
                console.log(simGames);
                var topTenSim = simGames.slice(0, 10);
                console.log(topTenSim);
                var title = "Simulation";
                drawBars(topTenSim, title);
            })



        }
        
        //take an array and draw the bars displaying name and player estimate
        var svg = d3.select("#chart1")
        
        function drawBars(data, title){
           
            svg.selectAll("g")
            .remove();
            svg.selectAll(".bar")
            .remove();



            console.log(data);
            
            var mean = 0;
            console.log(mean);
            function getMean(data) {
                for(let i = 0; i < data.length; i++) {
                    mean = parseInt(mean);
                    var dataInt = parseInt(data[i].SteamSpyPlayersEstimate);
                    mean = mean + dataInt;
                }
                return mean;
            }
            
            
            getMean(data);
            mean = Math.floor(mean/10);
            console.log(mean);
            
            var margin = 20;
            var width = 400 - margin;
            var height = 400 - margin;
            console.log(height);

            svg = d3.select("#chart1")
                .attr("width", width)
                .attr("height", height);

            var g = svg.append("g")
                .attr("transform", "translate(" + 200 + "," + 50 + ")");
            
            
            var yScale = d3.scaleBand()
            .range([0, height])
            .padding(0.1);

            
            var xScale = d3.scaleLinear()
                .range([width * 1.7, 0])
                .domain([data[0].SteamSpyPlayersEstimate, 0]);

            yScale.domain(data.map(function(d){
                return d.QueryName;
            }));

            g.append("g")
              
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                
                .call(d3.axisLeft(yScale).tickFormat(function(d){
                    return d;
                }).ticks(10));
            
            

            function startState(selection){
                selection  
                    .attr("y", 0)
                    .attr("height", 0);

            }
            console.log(data);


            function getColor(){
                var r = Math.floor(Math.random() * 256); 
                var g = Math.floor(Math.random() * 256);
                var b = Math.floor(Math.random() * 256);
                var thergb = "rgb(" + r + "," + g + "," + b + ")"; 
                console.log(thergb);
                return thergb;
                
            }
            
            // append the bars
            var bars = svg.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr("class", "bar")
            .call(startState)
            
           
            
            .on("mouseover", function(d){
                var tooltip = d3.select("#tooltip")
                .style("display", "block")
                .style("top", d3.event.pageY + 20 +"px")
                .style("left", d3.event.pageX + 20 + "px");

                tooltip
                .html(d.QueryName + "<br> <br> Estimate Players :" + d.SteamSpyPlayersEstimate + "<br> Estimate Owners : " + d.SteamSpyOwners + "<br> Rating by Metacritic :" + d.Metacritic);
            })
            .on("mouseout", function(d){
                d3.select("#tooltip")
                .style("display", "none");
            })
            .transition().duration(1000)
            .attr("width", function(d){
                return xScale(d.SteamSpyPlayersEstimate)
            })
            .attr("height", yScale.bandwidth())
            .attr("x", 200)
            .attr("y", function(d){
                return yScale(d.QueryName) + 50;
            })
            .attr("fill", function(d){
                var dInt = parseInt(d.SteamSpyPlayersEstimate);
                if(dInt >= mean){
                    return "blue";
                } else {
                    return "black";
                }
            });

            //label and the title of the chart
            g.append("text")
            .attr("x", -60)
            .attr("y", -10)
            .text("Games")
            .style("font-family", "tomorrow, sans-serif")
            .style("fill", "red")
            .style("stroke", "black")
            .style("stroke-width", "1px");

            g.append("text")
            .attr("x", 240)
            .attr("y", 430)
            .text("Estimate Players")
            .style("font-family", "tomorrow, sans-serif")
            .style("fill", "red")
            .style("stroke", "black")
            .style("stroke-width", "1px");

            g.append("text")
            .transition().duration(1000)
            .attr("x", 300)
            .attr("y", 350)
            .text(title)
            .style("font-size", "80px")
            .style("font-family", "Tomorrow, sans-serif")
            .style("font-weight", "bold")
            .style("fill", "black")
            .style("opacity", "0.7");







            
            





           
                
            
        










        }





        
       
      
        

        

    </script>

    <script src="./background.js"></script>
    <script src="./data.js"></script>
    <script src="./chart1.js"></script>
   

  </body>
</html>